<style>
  .safe-bottom { padding-bottom: calc(env(safe-area-inset-bottom) + 16px); }

  /* ✅ Medida única para toda la app */
  .app-shell { padding-left: 6px; padding-right: 6px; padding-top: 0px; padding-bottom: 0px; }
  @media (min-width: 640px) { .app-shell { padding-left: 12px; padding-right: 12px; } }
  @media (min-width: 768px) { .app-shell { padding-left: 16px; padding-right: 16px; } }
</style>

<div class="flex items-start justify-center min-h-[calc(100vh-200px)] app-shell py-6 sm:py-8">
  <div
    class="w-full max-w-full sm:max-w-5xl lg:max-w-7xl xl:max-w-screen-xl mx-auto
           bg-gradient-to-br from-slate-900/95 via-slate-900/90 to-slate-950/95
           backdrop-blur-md rounded-2xl shadow-2xl border border-slate-700/80
           p-4 sm:p-6 md:p-10 text-white safe-bottom overflow-x-hidden"
  >

    <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold text-center mb-6 sm:mb-10 tracking-tight">
      Panel del Cobrador
    </h1>

    <!-- Resumen -->
    <div class="bg-slate-900/70 border border-sky-500/60 rounded-xl p-4 shadow-md mb-6 sm:mb-10">
      <p class="text-xs uppercase tracking-wide text-sky-200/90">
        Monto recaudado actual
      </p>
      <p class="text-2xl sm:text-3xl font-extrabold text-sky-300 mt-1 break-words">
        <%= montoFormateado %>
      </p>
    </div>

    <!-- Accesos rápidos -->
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 sm:gap-6 mb-8 sm:mb-10">
      <a
        href="/cobros/buscar"
        class="block bg-slate-900/60 border border-slate-700/80 rounded-xl p-4 sm:p-6 shadow
               hover:bg-slate-900/80 hover:border-sky-400/60 transition min-h-[110px]"
      >
        <h2 class="text-lg sm:text-xl font-semibold text-sky-300 mb-1 sm:mb-2">
          Buscar Cliente
        </h2>
        <p class="text-sm text-slate-300">
          Busca un cliente por DNI para ver facturas y registrar un nuevo cobro.
        </p>
      </a>

      <a
        href="/cobrador/buscar"
        class="block bg-slate-900/60 border border-slate-700/80 rounded-xl p-4 sm:p-6 shadow
               hover:bg-slate-900/80 hover:border-emerald-400/60 transition min-h-[110px]"
      >
        <h2 class="text-lg sm:text-xl font-semibold text-emerald-300 mb-1 sm:mb-2">
          Nota de crédito o débito
        </h2>
        <p class="text-sm text-slate-300">
          Genera nuevos cargos para cobros ya realizados.
        </p>
      </a>
    </div>

    <!-- Últimos cobros -->
    <div class="mt-8 sm:mt-10">
      <h2 class="text-base sm:text-lg font-semibold text-white mb-3 sm:mb-4">
        Últimos cobros
      </h2>

      <div class="max-w-full bg-slate-900/70 shadow rounded-xl border border-slate-700/80 overflow-hidden">
        <div class="w-full max-w-full overflow-x-auto">
          <table class="min-w-[820px] w-full text-sm text-white">
            <thead class="bg-slate-800 text-sky-200 uppercase text-xs tracking-wide">
              <tr>
                <th class="px-3 py-3 text-left">Fecha</th>
                <th class="px-3 py-3 text-left">N° Comp.</th>
                <th class="px-3 py-3 text-left">Cliente</th>
                <th class="px-3 py-3 text-right">Importe</th>
                <th class="px-3 py-3 text-right">Recibo</th>
              </tr>
            </thead>
            <tbody>
              <% ultimosCobros.forEach(cobro=> { %>
                <tr class="border-t border-slate-700 hover:bg-slate-800/80 transition-colors">
                  <td class="px-3 py-2 whitespace-nowrap">
                    <%= new Date(cobro.fecha).toLocaleDateString() %>
                  </td>
                  <td class="px-3 py-2 whitespace-nowrap">
                    <%= cobro.numeroComprobante %>
                  </td>
                  <td class="px-3 py-2 truncate max-w-[180px] sm:max-w-[260px]">
                    <%= cobro.cliente %>
                  </td>
                  <td class="px-3 py-2 text-right whitespace-nowrap">
                    <%= cobro.importe.toLocaleString("es-AR", { style: "currency" , currency: "ARS" }) %>
                  </td>
                  <td class="px-3 py-2 text-right whitespace-nowrap">
                    <a href="/cobros/<%= cobro.idComprobante %>/recibo" class="text-sky-300 underline text-sm">
                      Ver
                    </a>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- Historial -->
    <div class="mt-8 sm:mt-10">
      <h2 class="text-base sm:text-lg font-semibold text-white mb-3 sm:mb-4">
        Historial financiero
      </h2>

      <div class="max-w-full bg-slate-900/70 shadow rounded-xl border border-slate-700/80 overflow-hidden">
        <div class="w-full max-w-full overflow-x-auto">
          <table class="min-w-[820px] w-full text-sm text-white">
            <thead class="bg-slate-800 text-sky-200 uppercase text-xs tracking-wide">
              <tr>
                <th class="px-3 py-3 text-left">Fecha</th>
                <th class="px-3 py-3 text-left">N° Comp.</th>
                <th class="px-3 py-3 text-left">Tipo</th>
                <th class="px-3 py-3 text-left">Detalle</th>
                <th class="px-3 py-3 text-right">Importe</th>
                <th class="px-3 py-3 text-right">Saldo</th>
              </tr>
            </thead>
            <tbody>
              <% if (movimientos.length===0) { %>
                <tr>
                  <td colspan="6" class="text-center py-4 text-slate-400">
                    Sin movimientos aún.
                  </td>
                </tr>
              <% } else { let saldo=0; movimientos.slice().reverse().forEach(mov=> { saldo += mov.importe; %>
                <tr class="border-t border-slate-700 hover:bg-slate-800/80 transition-colors">
                  <td class="px-3 py-2 whitespace-nowrap">
                    <%= new Date(mov.fecha).toLocaleDateString("es-AR") %>
                  </td>
                  <td class="px-3 py-2 whitespace-nowrap">
                    <%= mov.numeroComprobante || "-" %>
                  </td>
                  <td class="px-3 py-2 capitalize whitespace-nowrap">
                    <%= mov.tipo %>
                  </td>
                  <td class="px-3 py-2 truncate max-w-[220px] sm:max-w-[360px]">
                    <%= mov.detalle %>
                  </td>
                  <td class="px-3 py-2 text-right whitespace-nowrap <%= mov.importe < 0 ? 'text-rose-400' : 'text-emerald-400' %>">
                    <%= mov.importe.toLocaleString("es-AR", { style: "currency" , currency: "ARS" }) %>
                  </td>
                  <td class="px-3 py-2 text-right whitespace-nowrap font-semibold">
                    <%= saldo.toLocaleString("es-AR", { style: "currency" , currency: "ARS" }) %>
                  </td>
                </tr>
              <% }) } %>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>
