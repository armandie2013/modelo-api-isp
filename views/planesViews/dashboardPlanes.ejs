<main>
  <style>
    .safe-bottom { padding-bottom: calc(env(safe-area-inset-bottom) + 16px); }
  </style>

  <!-- ✅ IGUAL que Admin dashboard -->
  <div class="flex items-start justify-center min-h-[calc(100vh-200px)] px-2 sm:px-4 py-0 sm:py-5">
    <div
      class="w-full max-w-full sm:max-w-5xl lg:max-w-7xl xl:max-w-screen-xl mx-auto
             bg-gradient-to-br from-slate-900/95 via-slate-900/90 to-slate-950/95
             backdrop-blur-md rounded-2xl shadow-2xl border border-slate-700/80
             px-4 sm:px-6 md:px-10 py-6 sm:py-8 md:py-10 text-white safe-bottom"
    >

      <!-- Header -->
      <header class="mb-6 sm:mb-8">
        <p class="text-xs sm:text-sm uppercase tracking-[0.25em] text-slate-400 mb-2">
          Administración
        </p>

        <div class="flex flex-col sm:flex-row sm:items-end sm:justify-between gap-3 sm:gap-4">
          <div class="min-w-0">
            <h1 class="text-2xl sm:text-3xl md:text-4xl font-extrabold tracking-tight">
              Planes disponibles
            </h1>
            <p class="text-sm sm:text-base text-slate-300 mt-1">
              Gestión de planes del sistema.
            </p>
          </div>

          <a
            href="/planes/crear"
            class="inline-flex items-center justify-center gap-2
                   bg-sky-600 hover:bg-sky-700 active:bg-sky-800
                   text-white font-semibold
                   py-2.5 px-5 rounded-xl
                   shadow-md hover:shadow-lg transition
                   whitespace-nowrap"
          >
            Crear plan
          </a>
        </div>
      </header>

      <!-- Mensaje éxito -->
      <% if (typeof exito !== 'undefined' && exito) { %>
        <div class="mb-5 rounded-xl border border-emerald-400/40 bg-emerald-500/10 px-4 py-3 text-emerald-200 text-sm">
          <%= exito %>
        </div>
      <% } %>

      <% if (!planes || planes.length === 0) { %>

        <!-- Sin planes -->
        <div class="bg-slate-900/50 border border-slate-700/70 rounded-2xl p-6 text-center">
          <p class="text-slate-200 font-semibold">No hay planes cargados.</p>
          <p class="text-slate-400 text-sm mt-1">Creá el primero para comenzar.</p>
          <a
            href="/planes/crear"
            class="inline-flex mt-4 bg-sky-600 hover:bg-sky-700 text-white font-semibold px-5 py-2.5 rounded-xl shadow transition"
          >
            Crear primer plan
          </a>
        </div>

      <% } else { %>

        <!-- ================= MOBILE (cards) ================= -->
        <div class="space-y-3 sm:hidden">
          <% planes.forEach(plan => { %>
            <div class="bg-slate-900/55 border border-slate-700/70 rounded-2xl p-4 shadow">
              <div class="flex items-start justify-between gap-3">
                <div class="min-w-0">
                  <p class="text-white font-semibold text-base truncate">
                    <%= plan.nombre %>
                  </p>
                  <p class="text-slate-300 text-sm mt-1">
                    <span class="text-slate-400">Tipo:</span>
                    <span class="text-slate-200"><%= plan.tipo %></span>
                  </p>
                </div>

                <span class="shrink-0 text-emerald-300 font-semibold text-sm">
                  <%= plan.precioFormateado %>
                </span>
              </div>

              <div class="mt-4 grid grid-cols-2 gap-2">
                <a
                  href="/planes/editar/<%= plan._id %>"
                  class="text-center bg-slate-950/40 hover:bg-slate-950/60
                         border border-slate-700/70
                         text-sky-200 font-semibold py-2 rounded-xl transition text-sm"
                >
                  Editar
                </a>

                <form action="/planes/eliminar/<%= plan._id %>" method="POST">
                  <button
                    type="submit"
                    onclick="return confirm('¿Eliminar este plan?')"
                    class="w-full bg-rose-500/15 hover:bg-rose-500/25
                           border border-rose-400/30
                           text-rose-200 font-semibold py-2 rounded-xl transition text-sm"
                  >
                    Eliminar
                  </button>
                </form>
              </div>
            </div>
          <% }) %>
        </div>

        <!-- ================= DESKTOP / TABLET (tabla) ================= -->
        <div class="hidden sm:block bg-slate-900/50 border border-slate-700/70 rounded-2xl shadow-lg overflow-hidden">
          <table class="w-full text-sm">
            <thead class="bg-slate-950/40 text-slate-300 uppercase text-xs tracking-wide">
              <tr>
                <th class="px-4 py-4 text-left">Nombre</th>
                <th class="px-4 py-4 text-left">Tipo</th>
                <th class="px-4 py-4 text-right">Precio</th>
                <th class="px-4 py-4 text-right">Acciones</th>
              </tr>
            </thead>

            <tbody>
              <% planes.forEach(plan => { %>
                <tr class="border-t border-slate-700/70 hover:bg-slate-950/30 transition">
                  <td class="px-4 py-3 font-medium text-white">
                    <%= plan.nombre %>
                  </td>
                  <td class="px-4 py-3 text-slate-300">
                    <%= plan.tipo %>
                  </td>
                  <td class="px-4 py-3 text-right font-semibold text-emerald-200">
                    <%= plan.precioFormateado %>
                  </td>
                  <td class="px-4 py-3">
                    <div class="flex justify-end gap-2">
                      <a
                        href="/planes/editar/<%= plan._id %>"
                        class="bg-slate-950/40 hover:bg-slate-950/60
                               border border-slate-700/70
                               text-sky-200 font-semibold px-3 py-1.5 rounded-lg transition text-xs"
                      >
                        Editar
                      </a>

                      <form action="/planes/eliminar/<%= plan._id %>" method="POST">
                        <button
                          type="submit"
                          onclick="return confirm('¿Eliminar este plan?')"
                          class="bg-rose-500/15 hover:bg-rose-500/25
                                 border border-rose-400/30
                                 text-rose-200 font-semibold px-3 py-1.5 rounded-lg transition text-xs"
                        >
                          Eliminar
                        </button>
                      </form>
                    </div>
                  </td>
                </tr>
              <% }) %>
            </tbody>
          </table>
        </div>

      <% } %>

    </div>
  </div>
</main>
